(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9542,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let a=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}),n=r.forwardRef(function({title:e,titleId:t,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))});function l(){let[e,l]=(0,r.useState)(!1),o=(0,r.useRef)(null),i=async e=>{let t=e.target.files?.[0];if(!t)return;l(!0);let r=new FileReader;r.onload=async e=>{let t=e.target?.result;if(!t)return;let r=t.split(/\r?\n/).slice(1).map(e=>{let t=e.split(",");if(t.length<4)return null;let[r,a,n,l,o,i]=t;return{name:r?.trim(),category:a?.trim()||"Otros",pricingUnit:n?.trim()||"KG",pricePerUnit:parseFloat(l?.trim()||"0"),yieldPercent:parseFloat(o?.trim()||"100"),allergens:i?i.replace(/"/g,"").split(";").map(e=>e.trim()):[]}}).filter(e=>e&&e.name);try{let e=await fetch("/api/products/batch",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();alert(`Se han cargado ${t.count} productos correctamente.`),window.location.reload()}else alert("Error al cargar productos. Verifique el formato del CSV.")}catch(e){console.error(e),alert("Error de conexiÃ³n con el servidor.")}finally{l(!1),o.current&&(o.current.value="")}},r.readAsText(t)};return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>{let e=new Blob([["Nombre,Categoria,Unidad (KG/L/UD),Precio,Rendimiento (%),Alergenos (Separados por coma)",...[["Tomate Pera","Verduras","KG","1.50","100",""],["Harina Trigo","Secos","KG","0.80","100","Gluten"]].map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.setAttribute("download","plantilla_productos.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r)},className:"flex items-center gap-2 px-4 py-2 bg-white border border-blue-200 text-blue-700 rounded-md hover:bg-blue-50 text-sm font-medium shadow-sm transition-colors",title:"Descargar plantilla CSV",children:[(0,t.jsx)(a,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Plantilla CSV"})]}),(0,t.jsx)("input",{type:"file",id:"csv-upload",ref:o,onChange:i,accept:".csv",className:"hidden"}),(0,t.jsxs)("label",{htmlFor:"csv-upload",className:`flex items-center gap-2 px-4 py-2 bg-white border border-blue-200 text-blue-700 rounded-md hover:bg-blue-50 text-sm font-medium shadow-sm transition-colors cursor-pointer ${e?"opacity-50 cursor-not-allowed":""}`,children:[(0,t.jsx)(n,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:e?"Cargando...":"Cargar CSV"})]})]})}e.s(["CsvManager",()=>l],9542)}]);