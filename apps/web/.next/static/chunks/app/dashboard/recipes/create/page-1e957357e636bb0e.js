(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8606],{1217:(e,r,a)=>{Promise.resolve().then(a.bind(a,3283)),Promise.resolve().then(a.t.bind(a,5587,23))},2362:(e,r,a)=>{"use strict";a.d(r,{A:()=>l});var t=a(7620);let l=t.forwardRef(function({title:e,titleId:r,...a},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":r},a),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))})},3283:(e,r,a)=>{"use strict";a.d(r,{default:()=>m});var t=a(4568),l=a(5974);let s=(0,l.createServerReference)("60add12e9079a0b7bd490b3481606a870b22e1cb0a",l.callServer,void 0,l.findSourceMapURL,"createRecipe");var i=a(5587),n=a.n(i),o=a(2362),d=a(4378),c=a(7620);function m({ingredients:e,categories:r,packaging:a,availableSubRecipes:l=[]}){let[i,m]=(0,c.useActionState)(s,{message:null,errors:{}}),[u,p]=(0,c.useState)([]),x=(e,r,a)=>{let t=[...u];t[e]={...t[e],[r]:a},"ingredientId"===r&&(t[e].sourceProductId=""),p(t)},[h,b]=(0,c.useState)([]),g={CORTAR:["Brunoisse","Juliana","Mirepoix","Rodajas","Gajos"],DESPIEZAR:["Filetear","Picar","Limpiar","Deshuesar"],COCCION:["Directa","Indirecta","Al vac\xedo","Hervir","Sofre\xedr","Asar"],MEZCLAR:["Batir","Remover","Amasar"],OTROS:["Marinar","Reposar","Emplatar"]},j=(e,r,a)=>{let t=[...h];t[e]={...t[e],[r]:a},"action"===r&&(t[e].subAction=""),b(t)},v=u.map(r=>{let a=e.find(e=>e.id===r.ingredientId);return a?{id:a.id,name:a.name}:null}).filter(Boolean);return(0,t.jsxs)("form",{action:m,children:[(0,t.jsxs)("div",{className:"rounded-md bg-gray-50 p-4 md:p-6",children:[(0,t.jsx)("input",{type:"hidden",name:"items",value:JSON.stringify(u)}),(0,t.jsx)("input",{type:"hidden",name:"steps",value:JSON.stringify(h)}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Nombre de la Receta"}),(0,t.jsxs)("div",{className:"relative mt-2 rounded-md",children:[(0,t.jsx)("input",{id:"name",name:"name",type:"text",placeholder:"Ej. Salsa Bolo\xf1esa",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500","aria-describedby":"name-error"}),(0,t.jsx)("div",{id:"name-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.name&&i.errors.name.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,t.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4 border-b pb-6 border-gray-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"classification",className:"mb-2 block text-sm font-medium",children:"Clasificaci\xf3n"}),(0,t.jsxs)("select",{id:"classification",name:"classification",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Seleccionar Clasificaci\xf3n..."}),r.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,t.jsx)("div",{id:"classification-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.classification&&i.errors.classification.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"category",className:"mb-2 block text-sm font-medium",children:"Tipo de Receta"}),(0,t.jsxs)("select",{id:"category",name:"category",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"ELABORACION_FINAL",children:[(0,t.jsx)("option",{value:"PRODUCTO_NO_ELABORADO",children:"Producto No Elaborado"}),(0,t.jsx)("option",{value:"ELABORACION_INTERMEDIA",children:"Elaboraci\xf3n Intermedia"}),(0,t.jsx)("option",{value:"ELABORACION_FINAL",children:"Elaboraci\xf3n Final"})]}),(0,t.jsx)("div",{id:"category-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.category&&i.errors.category.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"packaging",className:"mb-2 block text-sm font-medium",children:"Envasado / Molde"}),(0,t.jsxs)("select",{id:"packaging",name:"packaging",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,t.jsx)("option",{value:"",children:"Seleccionar Envase..."}),a.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,t.jsx)("div",{id:"packaging-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.packaging&&i.errors.packaging.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"portions",className:"mb-2 block text-sm font-medium",children:"N\xba Raciones"}),(0,t.jsx)("input",{id:"portions",name:"portions",type:"number",placeholder:"Ej. 36",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,t.jsx)("div",{id:"portions-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.portions&&i.errors.portions.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"prepTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Preparaci\xf3n (mins)"}),(0,t.jsx)("input",{id:"prepTime",name:"prepTime",type:"number",placeholder:"15",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,t.jsx)("div",{id:"prepTime-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.prepTime&&i.errors.prepTime.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"cookTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Cocci\xf3n (mins)"}),(0,t.jsx)("input",{id:"cookTime",name:"cookTime",type:"number",placeholder:"27",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,t.jsx)("div",{id:"cookTime-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.cookTime&&i.errors.cookTime.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,t.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"yieldQuantity",className:"mb-2 block text-sm font-medium",children:"Rendimiento (Cantidad)"}),(0,t.jsx)("input",{id:"yieldQuantity",name:"yieldQuantity",type:"number",step:"0.01",placeholder:"Ej. 2.5",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"}),(0,t.jsx)("div",{id:"yieldQuantity-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.yieldQuantity&&i.errors.yieldQuantity.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"yieldUnit",className:"mb-2 block text-sm font-medium",children:"Unidad"}),(0,t.jsxs)("select",{id:"yieldUnit",name:"yieldUnit",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"KG",children:[(0,t.jsx)("option",{value:"KG",children:"KG"}),(0,t.jsx)("option",{value:"L",children:"L"}),(0,t.jsx)("option",{value:"UD",children:"Raciones / Unidades"})]}),(0,t.jsx)("div",{id:"yieldUnit-error","aria-live":"polite","aria-atomic":"true",children:i.errors?.yieldUnit&&i.errors.yieldUnit.map(e=>(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"instructions",className:"mb-2 block text-sm font-medium",children:"Notas"}),(0,t.jsx)("textarea",{id:"instructions",name:"instructions",rows:2,placeholder:"Resumen general...",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"})]}),(0,t.jsxs)("div",{className:"mb-4 mt-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:"Ingredientes"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{p([...u,{key:crypto.randomUUID(),type:"INGREDIENT",ingredientId:"",subRecipeId:"",sourceProductId:"",quantityGross:0,unit:"KG"}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,t.jsx)(o.A,{className:"w-4"})," A\xf1adir Ingrediente"]})]}),0===u.length&&(0,t.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay ingredientes a\xf1adidos."}),(0,t.jsx)("div",{className:"space-y-2",children:u.map((r,a)=>{let s;return(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 items-start md:items-center p-3 bg-white rounded border border-gray-200",children:[(0,t.jsx)("div",{className:"w-full md:w-32",children:(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm font-medium",value:r.type,onChange:e=>{let r=e.target.value,t=[...u];t[a]={...t[a],type:r,ingredientId:"",subRecipeId:"",sourceProductId:""},p(t)},children:[(0,t.jsx)("option",{value:"INGREDIENT",children:"Ingrediente"}),(0,t.jsx)("option",{value:"SUB_RECIPE",children:"Sub-Receta"})]})}),(0,t.jsx)("div",{className:"flex-grow w-full md:w-auto",children:"INGREDIENT"===r.type?(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:r.ingredientId,onChange:e=>x(a,"ingredientId",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Seleccionar Ingrediente..."}),e.map(e=>{let r=e.name,a=e.transformationOutputs?.map(e=>e.transformation.sourceProduct.name);if(a&&a.length>0){let t=Array.from(new Set(a));r=`${t.join(" / ")} - ${e.name}`}return(0,t.jsx)("option",{value:e.id,children:r},e.id)})]}):(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:r.subRecipeId,onChange:e=>x(a,"subRecipeId",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Seleccionar Sub-Receta..."}),l.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(s=e.find(e=>e.id===r.ingredientId))&&s.transformationOutputs&&s.transformationOutputs.length>0?(0,t.jsx)("div",{className:"flex-grow w-full md:w-auto",children:(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm text-gray-600",value:r.sourceProductId||"",onChange:e=>x(a,"sourceProductId",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"-- Origen Gen\xe9rico --"}),s.transformationOutputs.map(e=>(0,t.jsxs)("option",{value:e.transformation.sourceProduct.id,children:[e.transformation.sourceProduct.supplier?`${e.transformation.sourceProduct.supplier} - `:"",e.transformation.sourceProduct.name," (",e.percentage.toFixed(0),"%)"]},e.transformation.sourceProduct.id))]})}):null,(0,t.jsx)("div",{className:"w-full md:w-24",children:(0,t.jsx)("input",{type:"number",step:"any",placeholder:"Cant.",className:"block w-full rounded-md border-gray-200 text-sm",value:r.quantityGross,onChange:e=>x(a,"quantityGross",parseFloat(e.target.value))})}),(0,t.jsx)("div",{className:"w-full md:w-24",children:(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:r.unit,onChange:e=>x(a,"unit",e.target.value),children:[(0,t.jsx)("option",{value:"KG",children:"KG"}),(0,t.jsx)("option",{value:"G",children:"G"}),(0,t.jsx)("option",{value:"L",children:"L"}),(0,t.jsx)("option",{value:"ML",children:"ML"}),(0,t.jsx)("option",{value:"UD",children:"UD"})]})}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e;(e=[...u]).splice(a,1),p(e)},className:"text-red-500 hover:text-red-700 p-1",children:(0,t.jsx)(d.A,{className:"w-5"})})]},r.key)})})]}),(0,t.jsxs)("div",{className:"mb-6 mt-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:"M\xe9todo de elaboraci\xf3n (Pasos)"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{b([...h,{key:crypto.randomUUID(),order:h.length+1,description:"",action:"",subAction:"",ingredientId:""}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,t.jsx)(o.A,{className:"w-4"})," A\xf1adir Paso"]})]}),0===h.length&&(0,t.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay pasos definidos."}),(0,t.jsx)("div",{className:"space-y-4",children:h.map((e,r)=>(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-3 bg-white rounded border border-gray-200 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,t.jsx)("span",{className:"flex-none flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 font-bold text-xs text-gray-600 mt-1",children:e.order}),(0,t.jsx)("textarea",{className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",rows:2,placeholder:"",value:e.description,onChange:e=>j(r,"description",e.target.value)}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e;(e=[...h]).splice(r,1),b(e.map((e,r)=>({...e,order:r+1})))},className:"text-red-500 hover:text-red-700 p-1",children:(0,t.jsx)(d.A,{className:"w-5"})})]}),(0,t.jsxs)("div",{className:"ml-8 flex flex-wrap gap-2 items-center",children:[(0,t.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:e.action||"",onChange:e=>j(r,"action",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"-- Acci\xf3n --"}),Object.keys(g).map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),e.action&&g[e.action]&&(0,t.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:e.subAction||"",onChange:e=>j(r,"subAction",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"-- T\xe9cnica --"}),g[e.action].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6 max-w-[150px]",value:e.ingredientId||"",onChange:e=>j(r,"ingredientId",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"-- Ingrediente Relacionado --"}),v.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]},e.key))})]}),(0,t.jsx)("div",{"aria-live":"polite","aria-atomic":"true",children:i.message&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-500",children:i.message})})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end gap-4",children:[(0,t.jsx)(n(),{href:"/dashboard/recipes",className:"flex h-10 items-center rounded-lg bg-gray-100 px-4 text-sm font-medium text-gray-600 transition-colors hover:bg-gray-200",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"flex h-10 items-center rounded-lg bg-blue-600 px-4 text-sm font-medium text-white transition-colors hover:bg-blue-500",children:"Guardar Receta"})]})]})}},4378:(e,r,a)=>{"use strict";a.d(r,{A:()=>l});var t=a(7620);let l=t.forwardRef(function({title:e,titleId:r,...a},l){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":r},a),e?t.createElement("title",{id:r},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},5974:(e,r,a)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={callServer:function(){return s.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var l in t)Object.defineProperty(r,l,{enumerable:!0,get:t[l]});let s=a(4273),i=a(6409),n=a(7102)}},e=>{e.O(0,[5587,587,1968,7358],()=>e(e.s=1217)),_N_E=e.O()}]);