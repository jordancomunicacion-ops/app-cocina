(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,13107,e=>{"use strict";var r=e.i(71645);let a=r.forwardRef(function({title:e,titleId:a,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},t),e?r.createElement("title",{id:a},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});e.s(["PlusIcon",0,a],13107)},60759,e=>{"use strict";var r=e.i(71645);let a=r.forwardRef(function({title:e,titleId:a,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":a},t),e?r.createElement("title",{id:a},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});e.s(["TrashIcon",0,a],60759)},25108,e=>{"use strict";var r=e.i(43476),a=e.i(95187);let t=(0,a.createServerReference)("604fcd8a79668cadcacc8dd93af73162fe616f19d2",a.callServer,void 0,a.findSourceMapURL,"createRecipe");var l=e.i(22016),s=e.i(13107),i=e.i(60759),n=e.i(71645);function o({ingredients:e,categories:a,packaging:o,availableSubRecipes:d=[]}){let[c,m]=(0,n.useActionState)(t,{message:null,errors:{}}),[u,p]=(0,n.useState)([]),x=(e,r,a)=>{let t=[...u];t[e]={...t[e],[r]:a},"ingredientId"===r&&(t[e].sourceProductId=""),p(t)},[h,b]=(0,n.useState)([]),g={CORTAR:["Brunoisse","Juliana","Mirepoix","Rodajas","Gajos"],DESPIEZAR:["Filetear","Picar","Limpiar","Deshuesar"],COCCION:["Directa","Indirecta","Al vacío","Hervir","Sofreír","Asar"],MEZCLAR:["Batir","Remover","Amasar"],OTROS:["Marinar","Reposar","Emplatar"]},j=(e,r,a)=>{let t=[...h];t[e]={...t[e],[r]:a},"action"===r&&(t[e].subAction=""),b(t)},v=u.map(r=>{let a=e.find(e=>e.id===r.ingredientId);return a?{id:a.id,name:a.name}:null}).filter(Boolean);return(0,r.jsxs)("form",{action:m,children:[(0,r.jsxs)("div",{className:"rounded-md bg-gray-50 p-4 md:p-6",children:[(0,r.jsx)("input",{type:"hidden",name:"items",value:JSON.stringify(u)}),(0,r.jsx)("input",{type:"hidden",name:"steps",value:JSON.stringify(h)}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Nombre de la Receta"}),(0,r.jsxs)("div",{className:"relative mt-2 rounded-md",children:[(0,r.jsx)("input",{id:"name",name:"name",type:"text",placeholder:"Ej. Salsa Boloñesa",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500","aria-describedby":"name-error"}),(0,r.jsx)("div",{id:"name-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.name&&c.errors.name.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,r.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4 border-b pb-6 border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"classification",className:"mb-2 block text-sm font-medium",children:"Clasificación"}),(0,r.jsxs)("select",{id:"classification",name:"classification",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Seleccionar Clasificación..."}),a.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,r.jsx)("div",{id:"classification-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.classification&&c.errors.classification.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"mb-2 block text-sm font-medium",children:"Tipo de Receta"}),(0,r.jsxs)("select",{id:"category",name:"category",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"ELABORACION_FINAL",children:[(0,r.jsx)("option",{value:"PRODUCTO_NO_ELABORADO",children:"Producto No Elaborado"}),(0,r.jsx)("option",{value:"ELABORACION_INTERMEDIA",children:"Elaboración Intermedia"}),(0,r.jsx)("option",{value:"ELABORACION_FINAL",children:"Elaboración Final"})]}),(0,r.jsx)("div",{id:"category-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.category&&c.errors.category.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"packaging",className:"mb-2 block text-sm font-medium",children:"Envasado / Molde"}),(0,r.jsxs)("select",{id:"packaging",name:"packaging",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Envase..."}),o.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,r.jsx)("div",{id:"packaging-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.packaging&&c.errors.packaging.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"portions",className:"mb-2 block text-sm font-medium",children:"Nº Raciones"}),(0,r.jsx)("input",{id:"portions",name:"portions",type:"number",placeholder:"Ej. 36",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,r.jsx)("div",{id:"portions-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.portions&&c.errors.portions.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"prepTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Preparación (mins)"}),(0,r.jsx)("input",{id:"prepTime",name:"prepTime",type:"number",placeholder:"15",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,r.jsx)("div",{id:"prepTime-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.prepTime&&c.errors.prepTime.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"cookTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Cocción (mins)"}),(0,r.jsx)("input",{id:"cookTime",name:"cookTime",type:"number",placeholder:"27",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,r.jsx)("div",{id:"cookTime-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.cookTime&&c.errors.cookTime.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,r.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"yieldQuantity",className:"mb-2 block text-sm font-medium",children:"Rendimiento (Cantidad)"}),(0,r.jsx)("input",{id:"yieldQuantity",name:"yieldQuantity",type:"number",step:"0.01",placeholder:"Ej. 2.5",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"}),(0,r.jsx)("div",{id:"yieldQuantity-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.yieldQuantity&&c.errors.yieldQuantity.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"yieldUnit",className:"mb-2 block text-sm font-medium",children:"Unidad"}),(0,r.jsxs)("select",{id:"yieldUnit",name:"yieldUnit",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"KG",children:[(0,r.jsx)("option",{value:"KG",children:"KG"}),(0,r.jsx)("option",{value:"L",children:"L"}),(0,r.jsx)("option",{value:"UD",children:"Raciones / Unidades"})]}),(0,r.jsx)("div",{id:"yieldUnit-error","aria-live":"polite","aria-atomic":"true",children:c.errors?.yieldUnit&&c.errors.yieldUnit.map(e=>(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:e},e))})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"instructions",className:"mb-2 block text-sm font-medium",children:"Notas"}),(0,r.jsx)("textarea",{id:"instructions",name:"instructions",rows:2,placeholder:"Resumen general...",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"})]}),(0,r.jsxs)("div",{className:"mb-4 mt-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-bold",children:"Ingredientes"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{p([...u,{key:crypto.randomUUID(),type:"INGREDIENT",ingredientId:"",subRecipeId:"",sourceProductId:"",quantityGross:0,unit:"KG"}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,r.jsx)(s.PlusIcon,{className:"w-4"})," Añadir Ingrediente"]})]}),0===u.length&&(0,r.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay ingredientes añadidos."}),(0,r.jsx)("div",{className:"space-y-2",children:u.map((a,t)=>{let l;return(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 items-start md:items-center p-3 bg-white rounded border border-gray-200",children:[(0,r.jsx)("div",{className:"w-full md:w-32",children:(0,r.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm font-medium",value:a.type,onChange:e=>{let r=e.target.value,a=[...u];a[t]={...a[t],type:r,ingredientId:"",subRecipeId:"",sourceProductId:""},p(a)},children:[(0,r.jsx)("option",{value:"INGREDIENT",children:"Ingrediente"}),(0,r.jsx)("option",{value:"SUB_RECIPE",children:"Sub-Receta"})]})}),(0,r.jsx)("div",{className:"flex-grow w-full md:w-auto",children:"INGREDIENT"===a.type?(0,r.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:a.ingredientId,onChange:e=>x(t,"ingredientId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Ingrediente..."}),e.map(e=>{let a=e.name,t=e.transformationOutputs?.map(e=>e.transformation.sourceProduct.name);if(t&&t.length>0){let r=Array.from(new Set(t));a=`${r.join(" / ")} - ${e.name}`}return(0,r.jsx)("option",{value:e.id,children:a},e.id)})]}):(0,r.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:a.subRecipeId,onChange:e=>x(t,"subRecipeId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Sub-Receta..."}),d.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(l=e.find(e=>e.id===a.ingredientId))&&l.transformationOutputs&&l.transformationOutputs.length>0?(0,r.jsx)("div",{className:"flex-grow w-full md:w-auto",children:(0,r.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm text-gray-600",value:a.sourceProductId||"",onChange:e=>x(t,"sourceProductId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- Origen Genérico --"}),l.transformationOutputs.map(e=>(0,r.jsxs)("option",{value:e.transformation.sourceProduct.id,children:[e.transformation.sourceProduct.supplier?`${e.transformation.sourceProduct.supplier} - `:"",e.transformation.sourceProduct.name," (",e.percentage.toFixed(0),"%)"]},e.transformation.sourceProduct.id))]})}):null,(0,r.jsx)("div",{className:"w-full md:w-24",children:(0,r.jsx)("input",{type:"number",step:"any",placeholder:"Cant.",className:"block w-full rounded-md border-gray-200 text-sm",value:a.quantityGross,onChange:e=>x(t,"quantityGross",parseFloat(e.target.value))})}),(0,r.jsx)("div",{className:"w-full md:w-24",children:(0,r.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:a.unit,onChange:e=>x(t,"unit",e.target.value),children:[(0,r.jsx)("option",{value:"KG",children:"KG"}),(0,r.jsx)("option",{value:"G",children:"G"}),(0,r.jsx)("option",{value:"L",children:"L"}),(0,r.jsx)("option",{value:"ML",children:"ML"}),(0,r.jsx)("option",{value:"UD",children:"UD"})]})}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e;(e=[...u]).splice(t,1),p(e)},className:"text-red-500 hover:text-red-700 p-1",children:(0,r.jsx)(i.TrashIcon,{className:"w-5"})})]},a.key)})})]}),(0,r.jsxs)("div",{className:"mb-6 mt-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-bold",children:"Método de elaboración (Pasos)"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{b([...h,{key:crypto.randomUUID(),order:h.length+1,description:"",action:"",subAction:"",ingredientId:""}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,r.jsx)(s.PlusIcon,{className:"w-4"})," Añadir Paso"]})]}),0===h.length&&(0,r.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay pasos definidos."}),(0,r.jsx)("div",{className:"space-y-4",children:h.map((e,a)=>(0,r.jsxs)("div",{className:"flex flex-col gap-2 p-3 bg-white rounded border border-gray-200 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,r.jsx)("span",{className:"flex-none flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 font-bold text-xs text-gray-600 mt-1",children:e.order}),(0,r.jsx)("textarea",{className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",rows:2,placeholder:"",value:e.description,onChange:e=>j(a,"description",e.target.value)}),(0,r.jsx)("button",{type:"button",onClick:()=>{let e;(e=[...h]).splice(a,1),b(e.map((e,r)=>({...e,order:r+1})))},className:"text-red-500 hover:text-red-700 p-1",children:(0,r.jsx)(i.TrashIcon,{className:"w-5"})})]}),(0,r.jsxs)("div",{className:"ml-8 flex flex-wrap gap-2 items-center",children:[(0,r.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:e.action||"",onChange:e=>j(a,"action",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- Acción --"}),Object.keys(g).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),e.action&&g[e.action]&&(0,r.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:e.subAction||"",onChange:e=>j(a,"subAction",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- Técnica --"}),g[e.action].map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6 max-w-[150px]",value:e.ingredientId||"",onChange:e=>j(a,"ingredientId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- Ingrediente Relacionado --"}),v.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]},e.key))})]}),(0,r.jsx)("div",{"aria-live":"polite","aria-atomic":"true",children:c.message&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-500",children:c.message})})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end gap-4",children:[(0,r.jsx)(l.default,{href:"/dashboard/recipes",className:"flex h-10 items-center rounded-lg bg-gray-100 px-4 text-sm font-medium text-gray-600 transition-colors hover:bg-gray-200",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",className:"flex h-10 items-center rounded-lg bg-blue-600 px-4 text-sm font-medium text-white transition-colors hover:bg-blue-500",children:"Guardar Receta"})]})]})}e.s(["default",()=>o],25108)}]);