module.exports=[25707,a=>{"use strict";var b=a.i(72131);let c=b.forwardRef(function({title:a,titleId:c,...d},e){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":c},d),a?b.createElement("title",{id:c},a):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});a.s(["PlusIcon",0,c],25707)},3471,a=>{"use strict";var b=a.i(72131);let c=b.forwardRef(function({title:a,titleId:c,...d},e){return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":c},d),a?b.createElement("title",{id:c},a):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});a.s(["TrashIcon",0,c],3471)},16536,a=>{"use strict";var b=a.i(87924),c=a.i(5050);let d=(0,c.createServerReference)("607c479d2ed2c12eeb77398a26cf33bad91b087e8b",c.callServer,void 0,c.findSourceMapURL,"createTransformation");var e=a.i(72131),f=a.i(25707),g=a.i(3471);function h({product:a,ingredients:c}){let[h,i]=(0,e.useActionState)(d,{message:null,errors:{}}),[j,k]=(0,e.useState)(1),[l,m]=(0,e.useState)([{key:"1",ingredientId:"",newIngredientName:"",weight:"",costAllocation:1}]),n=(a,b,c)=>{let d=[...l];d[a]={...d[a],[b]:c},m(d)},o=l.reduce((a,b)=>a+(Number(b.weight)||0),0),p=j>0?o/j*100:0;return(0,b.jsxs)("form",{action:i,children:[(0,b.jsx)("input",{type:"hidden",name:"sourceProductId",value:a.id}),(0,b.jsx)("input",{type:"hidden",name:"outputs",value:JSON.stringify(l)}),(0,b.jsxs)("div",{className:"rounded-md bg-gray-50 p-4 md:p-6 mb-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nombre de la Transformación"}),(0,b.jsx)("input",{name:"name",type:"text",placeholder:"Ej. Limpieza Standard, Despiece Completo...",className:"w-full rounded-md border-gray-200 py-2 pl-4 text-sm"}),(0,b.jsx)("div",{id:"name-error","aria-live":"polite","aria-atomic":"true",children:h.errors?.name&&h.errors.name.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Cantidad"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{name:"testQuantity",type:"number",step:"any",value:j,onChange:a=>k(parseFloat(a.target.value)),className:"w-32 rounded-md border-gray-200 py-2 pl-4 text-sm"}),(0,b.jsx)("span",{className:"font-bold text-gray-600",children:a.unit}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["( de ",a.name," )"]})]}),(0,b.jsx)("div",{id:"testQuantity-error","aria-live":"polite","aria-atomic":"true",children:h.errors?.testQuantity&&h.errors.testQuantity.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]})]}),(0,b.jsxs)("div",{className:"rounded-md bg-white border border-gray-200 p-4 md:p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold",children:"Desglose (Salidas)"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsxs)("span",{className:`font-bold ${1>Math.abs(100-p)?"text-green-600":"text-orange-500"}`,children:["Rendimiento Total: ",p.toFixed(1),"%"]}),(0,b.jsx)("span",{className:"text-gray-400 mx-2",children:"|"}),(0,b.jsxs)("span",{children:["Total Peso: ",o.toFixed(3)," ",a.unit]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 text-xs font-semibold text-gray-500 uppercase",children:[(0,b.jsx)("div",{className:"col-span-5",children:"Ingrediente Resultante"}),(0,b.jsx)("div",{className:"col-span-2",children:"Peso Obtenido"}),(0,b.jsx)("div",{className:"col-span-2",children:"Factor Coste"}),(0,b.jsx)("div",{className:"col-span-2",children:"Rendimiento"}),(0,b.jsx)("div",{className:"col-span-1"})]}),l.map((a,d)=>{let e=Number(a.weight)||0,f=j>0?e/j*100:0;return(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-center bg-gray-50 p-2 rounded",children:[(0,b.jsxs)("div",{className:"col-span-5",children:[(0,b.jsx)("input",{type:"text",list:`ingredients-${d}`,className:"w-full rounded border-gray-200 text-sm py-1",placeholder:"Nombre del ingrediente (ej. Solomillo Limpio)",value:a.newIngredientName,onChange:a=>n(d,"newIngredientName",a.target.value)}),(0,b.jsx)("datalist",{id:`ingredients-${d}`,children:c.map(a=>{let c=a.name;if(a.transformationOutputs&&a.transformationOutputs.length>0&&a.transformationOutputs[0].transformation?.sourceProduct){let b=a.transformationOutputs[0].transformation.sourceProduct.name;c.toLowerCase().includes(b.toLowerCase())||(c=`${b} - ${a.name}`)}return(0,b.jsx)("option",{value:c},a.id)})}),(0,b.jsx)("input",{type:"hidden",value:a.ingredientId})]}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)("input",{type:"number",step:"any",className:"w-full rounded border-gray-200 text-sm py-1",value:a.weight,onChange:a=>n(d,"weight",""===a.target.value?"":parseFloat(a.target.value))})}),(0,b.jsxs)("div",{className:"col-span-2 relative group",children:[(0,b.jsx)("input",{type:"number",step:"0.1",className:"w-full rounded border-gray-200 text-sm py-1",value:a.costAllocation,onChange:a=>n(d,"costAllocation",""===a.target.value?"":parseFloat(a.target.value))}),(0,b.jsxs)("div",{className:"hidden group-hover:block absolute bottom-full left-0 w-48 bg-gray-800 text-white text-xs p-2 rounded z-20 mb-1 shadow-lg",children:["Asigna valor: ",(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"1"})," = Normal (Proporcional)",(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"0"})," = Merma (Sin valor)",(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"1.5"})," = Parte noble (Más cara)",(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"0.5"})," = Recorte (Más barato)"]})]}),(0,b.jsxs)("div",{className:"col-span-2 text-center text-sm font-medium",children:[f.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"col-span-1 flex justify-end",children:(0,b.jsx)("button",{type:"button",onClick:()=>{let a;(a=[...l]).splice(d,1),m(a)},className:"text-red-500 hover:text-red-700",children:(0,b.jsx)(g.TrashIcon,{className:"w-5"})})})]},a.key)})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)("button",{type:"button",onClick:()=>{m([...l,{key:crypto.randomUUID(),ingredientId:"",newIngredientName:"",weight:"",costAllocation:1}])},className:"flex items-center gap-1 text-sm text-blue-600 font-medium",children:[(0,b.jsx)(f.PlusIcon,{className:"w-4"})," Añadir Salida"]})})]}),(0,b.jsx)("div",{"aria-live":"polite","aria-atomic":"true",className:"mt-4",children:h.message&&(0,b.jsx)("p",{className:"text-sm text-red-500",children:h.message})}),(0,b.jsx)("div",{className:"mt-6 flex justify-end gap-4",children:(0,b.jsx)("button",{type:"submit",className:"flex h-10 items-center rounded-lg bg-blue-600 px-4 text-sm font-medium text-white transition-colors hover:bg-blue-500",children:"Guardar Transformación"})})]})}a.s(["default",()=>h],16536)}];

//# sourceMappingURL=_0367d192._.js.map