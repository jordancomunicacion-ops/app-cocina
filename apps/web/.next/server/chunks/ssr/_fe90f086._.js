module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},25982,a=>{"use strict";var b=a.i(53112);let c=b.z.object({id:b.z.string(),name:b.z.string().min(1,{message:"El nombre es obligatorio."}),category:b.z.string().optional(),pricingUnit:b.z.enum(["KG","G","L","ML","UD"]),pricePerUnit:b.z.coerce.number().gt(0,{message:"El precio debe ser mayor a 0."}),yieldPercent:b.z.coerce.number().min(0).max(100,{message:"El rendimiento debe estar entre 0 y 100."}),allergens:b.z.string().optional(),supplierId:b.z.string().optional()}),d=c.omit({id:!0}),e=b.z.object({id:b.z.string().optional(),ingredientId:b.z.string().optional().nullable(),subRecipeId:b.z.string().optional().nullable(),sourceProductId:b.z.string().optional().nullable(),type:b.z.enum(["INGREDIENT","SUB_RECIPE"]),quantityGross:b.z.coerce.number().gt(0,{message:"La cantidad debe ser mayor a 0."}),unit:b.z.enum(["KG","G","L","ML","UD"])}),f=b.z.object({id:b.z.string().optional(),order:b.z.coerce.number(),description:b.z.string().min(1,{message:"La descripción es obligatoria."}),action:b.z.string().optional(),subAction:b.z.string().optional(),ingredientId:b.z.string().optional().nullable()}),g=b.z.object({id:b.z.string(),name:b.z.string().min(1,{message:"El nombre es obligatorio."}),category:b.z.enum(["PRODUCTO_NO_ELABORADO","ELABORACION_INTERMEDIA","ELABORACION_FINAL"]),classification:b.z.string().optional(),packaging:b.z.string().optional(),portions:b.z.preprocess(a=>""===a?null:Number(a),b.z.number().min(1,{message:"Debe ser mayor a 0"}).optional().nullable()),prepTime:b.z.preprocess(a=>""===a?null:Number(a),b.z.number().min(0).optional().nullable()),cookTime:b.z.preprocess(a=>""===a?null:Number(a),b.z.number().min(0).optional().nullable()),yieldQuantity:b.z.coerce.number().gt(0,{message:"El rendimiento debe ser mayor a 0."}),yieldUnit:b.z.enum(["KG","G","L","ML","UD"]).optional(),instructions:b.z.string().optional(),items:b.z.array(e).optional(),steps:b.z.array(f).optional()}),h=g.omit({id:!0}),i=b.z.object({id:b.z.string().optional(),recipeId:b.z.string().min(1,{message:"Debe seleccionar una receta."}),servingsOverride:b.z.coerce.number().optional().nullable()}),j=b.z.object({id:b.z.string(),name:b.z.string().min(1,{message:"El nombre del evento es obligatorio."}),date:b.z.string().transform(a=>new Date(a)),pax:b.z.coerce.number().gt(0,{message:"El número de personas debe ser mayor a 0."}),safetyMargin:b.z.coerce.number().min(1,{message:"El margen debe ser al menos 1.0 (100%)."}),status:b.z.enum(["DRAFT","CONFIRMED","COMPLETED"]).optional(),menuItems:b.z.array(i).optional()}),k=j.omit({id:!0}),l=b.z.object({id:b.z.string(),name:b.z.string().min(1,{message:"El nombre es obligatorio."}),email:b.z.string().email({message:"Email inválido."}),password:b.z.string().min(6,{message:"La contraseña debe tener al menos 6 caracteres."}).optional(),role:b.z.enum(["ADMIN","CHEF","EMPLOYEE"]),firstName:b.z.string().optional(),lastName:b.z.string().optional(),dni:b.z.string().optional(),phone:b.z.string().optional(),jobTitle:b.z.string().optional(),dob:b.z.string().optional()}),m=l.omit({id:!0}).extend({password:b.z.string().min(6,{message:"La contraseña es obligatoria."})}),n=b.z.object({id:b.z.string(),title:b.z.string().min(1,{message:"El título es obligatorio."}),description:b.z.string().optional(),assignedToUserId:b.z.string().optional().nullable(),status:b.z.enum(["PENDING","IN_PROGRESS","DONE","ISSUE"]),recipeId:b.z.string().optional().nullable(),targetQuantity:b.z.coerce.number().optional().nullable(),plannedStart:b.z.string().optional().nullable(),plannedEnd:b.z.string().optional().nullable()}).omit({id:!0,status:!0});a.s(["CreateEventSchema",0,k,"CreateIngredientSchema",0,d,"CreateRecipeSchema",0,h,"CreateTaskSchema",0,n,"CreateUserSchema",0,m,"UpdateEventSchema",0,j,"UpdateIngredientSchema",0,c,"UpdateRecipeSchema",0,g,"UpdateUserSchema",0,l])},82919,a=>a.a(async(b,c)=>{try{var d=a.i(37936),e=a.i(47525);a.i(40522);var f=a.i(9349),g=a.i(25982),h=a.i(44950),i=a.i(63021);a.i(70396);var j=a.i(73727),k=a.i(13095),l=b([e,h]);async function m(a,b){try{await (0,e.signIn)("credentials",{...Object.fromEntries(b),redirectTo:"/dashboard"})}catch(a){if(console.error("Auth Error:",a),a instanceof f.AuthError){if(console.error("Auth Error Type:",a.type),"CredentialsSignin"===a.type)return"Invalid credentials.";return"Something went wrong."}throw a}}async function n(){await (0,e.signOut)()}[e,h]=l.then?(await l)():l;let p=new i.PrismaClient;async function o(a,b){let c=g.CreateUserSchema.safeParse({name:b.get("name"),email:b.get("email"),password:b.get("password"),role:b.get("role")});if(!c.success)return{errors:c.error.flatten().fieldErrors,message:"Faltan campos obligatorios. Error al registrar usuario."};let{name:d,email:e,password:f,role:i}=c.data,k=await h.default.hash(f,10);try{await p.user.create({data:{name:d,email:e,password:k,role:i}})}catch(a){if("P2002"===a.code)return{message:"El email ya está uso."};return{message:"Error de base de datos: Error al registrar usuario."}}(0,j.redirect)("/login")}(0,k.ensureServerEntryExports)([m,n,o]),(0,d.registerServerReference)(m,"60adfdadc4b7b21a8f0a83aa2edaa389f39f0e987d",null),(0,d.registerServerReference)(n,"007ee69180cc5dfd929eff6368f4b57b396a0cb651",null),(0,d.registerServerReference)(o,"60622933cf9ec826cda69d3234a9eefe6e39396909",null),a.s(["authenticate",()=>m,"registerUser",()=>o,"signOutAction",()=>n]),c()}catch(a){c(a)}},!1),48726,a=>{"use strict";var b=a.i(37936),c=a.i(73794),d=a.i(18558);a.i(70396);var e=a.i(73727),f=a.i(25982);async function g(a,b){let g=b.get("items"),h=g?JSON.parse(g):[],i=b.get("steps"),j=i?JSON.parse(i):[],k=f.CreateRecipeSchema.safeParse({name:b.get("name"),category:b.get("category"),classification:b.get("classification"),packaging:b.get("packaging"),portions:b.get("portions"),prepTime:b.get("prepTime"),cookTime:b.get("cookTime"),yieldQuantity:b.get("yieldQuantity"),yieldUnit:b.get("yieldUnit"),instructions:b.get("instructions"),items:h,steps:j});if(!k.success)return{errors:k.error.flatten().fieldErrors,message:"Faltan campos obligatorios o datos inválidos."};let{name:l,category:m,classification:n,packaging:o,portions:p,prepTime:q,cookTime:r,yieldQuantity:s,yieldUnit:t,instructions:u,items:v,steps:w}=k.data;try{await c.prisma.recipe.create({data:{name:l,category:m,classification:n,packaging:o,portions:p,prepTime:q,cookTime:r,yieldQuantity:s,yieldUnit:t,instructions:u,items:{create:v?.map(a=>({type:a.type,ingredientId:a.ingredientId||void 0,subRecipeId:a.subRecipeId||void 0,sourceProductId:a.sourceProductId||void 0,quantityGross:a.quantityGross,unit:a.unit}))},steps:{create:w?.map(a=>({order:a.order,description:a.description,action:a.action||null,subAction:a.subAction||null,ingredientId:a.ingredientId||null}))}}})}catch(a){return console.error("Database Error:",a),{message:"Error de base de datos: No se pudo crear la receta."}}(0,d.revalidatePath)("/dashboard/recipes"),(0,e.redirect)("/dashboard/recipes")}async function h(a,b,g){let h=g.get("items"),i=h?JSON.parse(h):[],j=g.get("steps"),k=j?JSON.parse(j):[],l=f.UpdateRecipeSchema.safeParse({id:a,name:g.get("name"),category:g.get("category"),classification:g.get("classification"),packaging:g.get("packaging"),portions:g.get("portions"),prepTime:g.get("prepTime"),cookTime:g.get("cookTime"),yieldQuantity:g.get("yieldQuantity"),yieldUnit:g.get("yieldUnit"),instructions:g.get("instructions"),items:i,steps:k});if(!l.success)return{errors:l.error.flatten().fieldErrors,message:"Faltan campos obligatorios."};let{name:m,category:n,classification:o,packaging:p,portions:q,prepTime:r,cookTime:s,yieldQuantity:t,yieldUnit:u,instructions:v,items:w,steps:x}=l.data;try{await c.prisma.$transaction(async b=>{await b.recipe.update({where:{id:a},data:{name:m,category:n,classification:o,packaging:p,portions:q,prepTime:r,cookTime:s,yieldQuantity:t,yieldUnit:u,instructions:v}}),await b.recipeItem.deleteMany({where:{recipeId:a}}),await b.recipeStep.deleteMany({where:{recipeId:a}}),w&&w.length>0&&await b.recipeItem.createMany({data:w.map(b=>({recipeId:a,type:b.type,ingredientId:b.ingredientId||null,subRecipeId:b.subRecipeId||null,sourceProductId:b.sourceProductId||null,quantityGross:b.quantityGross,unit:b.unit}))}),x&&x.length>0&&await b.recipeStep.createMany({data:x.map(b=>({recipeId:a,order:b.order,description:b.description,action:b.action||null,subAction:b.subAction||null,ingredientId:b.ingredientId||null}))})})}catch(a){return console.error("Database Error:",a),{message:"Error de base de datos: No se pudo actualizar la receta."}}(0,d.revalidatePath)("/dashboard/recipes"),(0,e.redirect)("/dashboard/recipes")}async function i(a){try{return await c.prisma.recipe.delete({where:{id:a}}),(0,d.revalidatePath)("/dashboard/recipes"),{message:"Receta eliminada."}}catch(a){return console.error("Database Error:",a),{message:"Error de base de datos: No se pudo eliminar la receta."}}}(0,a.i(13095).ensureServerEntryExports)([g,h,i]),(0,b.registerServerReference)(g,"604fcd8a79668cadcacc8dd93af73162fe616f19d2",null),(0,b.registerServerReference)(h,"703854b2d1158bb90b3265336d860233239a09726f",null),(0,b.registerServerReference)(i,"40dc9e4f04e44263dbfa3ba8d101749c26494139d9",null),a.s(["createRecipe",()=>g,"deleteRecipe",()=>i,"updateRecipe",()=>h])},77840,a=>a.a(async(b,c)=>{try{var d=a.i(82919);a.i(48726);var e=b([d]);[d]=e.then?(await e)():e,a.s([]),c()}catch(a){c(a)}},!1),5118,a=>a.a(async(b,c)=>{try{var d=a.i(77840),e=a.i(82919),f=a.i(48726),g=b([d,e]);[d,e]=g.then?(await g)():g,a.s(["007ee69180cc5dfd929eff6368f4b57b396a0cb651",()=>e.signOutAction,"40dc9e4f04e44263dbfa3ba8d101749c26494139d9",()=>f.deleteRecipe,"604fcd8a79668cadcacc8dd93af73162fe616f19d2",()=>f.createRecipe,"703854b2d1158bb90b3265336d860233239a09726f",()=>f.updateRecipe]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_fe90f086._.js.map