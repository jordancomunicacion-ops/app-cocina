module.exports=[75896,a=>{"use strict";var b=a.i(87924),c=a.i(5050);let d=(0,c.createServerReference)("604fcd8a79668cadcacc8dd93af73162fe616f19d2",c.callServer,void 0,c.findSourceMapURL,"createRecipe");var e=a.i(38246),f=a.i(25707),g=a.i(3471),h=a.i(72131);function i({ingredients:a,categories:c,packaging:i,availableSubRecipes:j=[]}){let[k,l]=(0,h.useActionState)(d,{message:null,errors:{}}),[m,n]=(0,h.useState)([]),o=(a,b,c)=>{let d=[...m];d[a]={...d[a],[b]:c},"ingredientId"===b&&(d[a].sourceProductId=""),n(d)},[p,q]=(0,h.useState)([]),r={CORTAR:["Brunoisse","Juliana","Mirepoix","Rodajas","Gajos"],DESPIEZAR:["Filetear","Picar","Limpiar","Deshuesar"],COCCION:["Directa","Indirecta","Al vacío","Hervir","Sofreír","Asar"],MEZCLAR:["Batir","Remover","Amasar"],OTROS:["Marinar","Reposar","Emplatar"]},s=(a,b,c)=>{let d=[...p];d[a]={...d[a],[b]:c},"action"===b&&(d[a].subAction=""),q(d)},t=m.map(b=>{let c=a.find(a=>a.id===b.ingredientId);return c?{id:c.id,name:c.name}:null}).filter(Boolean);return(0,b.jsxs)("form",{action:l,children:[(0,b.jsxs)("div",{className:"rounded-md bg-gray-50 p-4 md:p-6",children:[(0,b.jsx)("input",{type:"hidden",name:"items",value:JSON.stringify(m)}),(0,b.jsx)("input",{type:"hidden",name:"steps",value:JSON.stringify(p)}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{htmlFor:"name",className:"mb-2 block text-sm font-medium",children:"Nombre de la Receta"}),(0,b.jsxs)("div",{className:"relative mt-2 rounded-md",children:[(0,b.jsx)("input",{id:"name",name:"name",type:"text",placeholder:"Ej. Salsa Boloñesa",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500","aria-describedby":"name-error"}),(0,b.jsx)("div",{id:"name-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.name&&k.errors.name.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]})]}),(0,b.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4 border-b pb-6 border-gray-200",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"classification",className:"mb-2 block text-sm font-medium",children:"Clasificación"}),(0,b.jsxs)("select",{id:"classification",name:"classification",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Seleccionar Clasificación..."}),c.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),(0,b.jsx)("div",{id:"classification-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.classification&&k.errors.classification.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"category",className:"mb-2 block text-sm font-medium",children:"Tipo de Receta"}),(0,b.jsxs)("select",{id:"category",name:"category",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"ELABORACION_FINAL",children:[(0,b.jsx)("option",{value:"PRODUCTO_NO_ELABORADO",children:"Producto No Elaborado"}),(0,b.jsx)("option",{value:"ELABORACION_INTERMEDIA",children:"Elaboración Intermedia"}),(0,b.jsx)("option",{value:"ELABORACION_FINAL",children:"Elaboración Final"})]}),(0,b.jsx)("div",{id:"category-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.category&&k.errors.category.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"packaging",className:"mb-2 block text-sm font-medium",children:"Envasado / Molde"}),(0,b.jsxs)("select",{id:"packaging",name:"packaging",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"",children:[(0,b.jsx)("option",{value:"",children:"Seleccionar Envase..."}),i.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),(0,b.jsx)("div",{id:"packaging-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.packaging&&k.errors.packaging.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"portions",className:"mb-2 block text-sm font-medium",children:"Nº Raciones"}),(0,b.jsx)("input",{id:"portions",name:"portions",type:"number",placeholder:"Ej. 36",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,b.jsx)("div",{id:"portions-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.portions&&k.errors.portions.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"prepTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Preparación (mins)"}),(0,b.jsx)("input",{id:"prepTime",name:"prepTime",type:"number",placeholder:"15",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,b.jsx)("div",{id:"prepTime-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.prepTime&&k.errors.prepTime.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"cookTime",className:"mb-2 block text-sm font-medium",children:"Tiempo Cocción (mins)"}),(0,b.jsx)("input",{id:"cookTime",name:"cookTime",type:"number",placeholder:"27",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm placeholder:text-gray-500"}),(0,b.jsx)("div",{id:"cookTime-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.cookTime&&k.errors.cookTime.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]})]}),(0,b.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"yieldQuantity",className:"mb-2 block text-sm font-medium",children:"Rendimiento (Cantidad)"}),(0,b.jsx)("input",{id:"yieldQuantity",name:"yieldQuantity",type:"number",step:"0.01",placeholder:"Ej. 2.5",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"}),(0,b.jsx)("div",{id:"yieldQuantity-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.yieldQuantity&&k.errors.yieldQuantity.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"yieldUnit",className:"mb-2 block text-sm font-medium",children:"Unidad"}),(0,b.jsxs)("select",{id:"yieldUnit",name:"yieldUnit",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500",defaultValue:"KG",children:[(0,b.jsx)("option",{value:"KG",children:"KG"}),(0,b.jsx)("option",{value:"L",children:"L"}),(0,b.jsx)("option",{value:"UD",children:"Raciones / Unidades"})]}),(0,b.jsx)("div",{id:"yieldUnit-error","aria-live":"polite","aria-atomic":"true",children:k.errors?.yieldUnit&&k.errors.yieldUnit.map(a=>(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:a},a))})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{htmlFor:"instructions",className:"mb-2 block text-sm font-medium",children:"Notas"}),(0,b.jsx)("textarea",{id:"instructions",name:"instructions",rows:2,placeholder:"Resumen general...",className:"peer block w-full rounded-md border border-gray-200 py-2 pl-4 text-sm outline-2 placeholder:text-gray-500"})]}),(0,b.jsxs)("div",{className:"mb-4 mt-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-bold",children:"Ingredientes"}),(0,b.jsxs)("button",{type:"button",onClick:()=>{n([...m,{key:crypto.randomUUID(),type:"INGREDIENT",ingredientId:"",subRecipeId:"",sourceProductId:"",quantityGross:0,unit:"KG"}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,b.jsx)(f.PlusIcon,{className:"w-4"})," Añadir Ingrediente"]})]}),0===m.length&&(0,b.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay ingredientes añadidos."}),(0,b.jsx)("div",{className:"space-y-2",children:m.map((c,d)=>{let e;return(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 items-start md:items-center p-3 bg-white rounded border border-gray-200",children:[(0,b.jsx)("div",{className:"w-full md:w-32",children:(0,b.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm font-medium",value:c.type,onChange:a=>{let b=a.target.value,c=[...m];c[d]={...c[d],type:b,ingredientId:"",subRecipeId:"",sourceProductId:""},n(c)},children:[(0,b.jsx)("option",{value:"INGREDIENT",children:"Ingrediente"}),(0,b.jsx)("option",{value:"SUB_RECIPE",children:"Sub-Receta"})]})}),(0,b.jsx)("div",{className:"flex-grow w-full md:w-auto",children:"INGREDIENT"===c.type?(0,b.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:c.ingredientId,onChange:a=>o(d,"ingredientId",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Seleccionar Ingrediente..."}),a.map(a=>{let c=a.name,d=a.transformationOutputs?.map(a=>a.transformation.sourceProduct.name);if(d&&d.length>0){let b=Array.from(new Set(d));c=`${b.join(" / ")} - ${a.name}`}return(0,b.jsx)("option",{value:a.id,children:c},a.id)})]}):(0,b.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:c.subRecipeId,onChange:a=>o(d,"subRecipeId",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"Seleccionar Sub-Receta..."}),j.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})}),(e=a.find(a=>a.id===c.ingredientId))&&e.transformationOutputs&&e.transformationOutputs.length>0?(0,b.jsx)("div",{className:"flex-grow w-full md:w-auto",children:(0,b.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm text-gray-600",value:c.sourceProductId||"",onChange:a=>o(d,"sourceProductId",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"-- Origen Genérico --"}),e.transformationOutputs.map(a=>(0,b.jsxs)("option",{value:a.transformation.sourceProduct.id,children:[a.transformation.sourceProduct.supplier?`${a.transformation.sourceProduct.supplier} - `:"",a.transformation.sourceProduct.name," (",a.percentage.toFixed(0),"%)"]},a.transformation.sourceProduct.id))]})}):null,(0,b.jsx)("div",{className:"w-full md:w-24",children:(0,b.jsx)("input",{type:"number",step:"any",placeholder:"Cant.",className:"block w-full rounded-md border-gray-200 text-sm",value:c.quantityGross,onChange:a=>o(d,"quantityGross",parseFloat(a.target.value))})}),(0,b.jsx)("div",{className:"w-full md:w-24",children:(0,b.jsxs)("select",{className:"block w-full rounded-md border-gray-200 text-sm",value:c.unit,onChange:a=>o(d,"unit",a.target.value),children:[(0,b.jsx)("option",{value:"KG",children:"KG"}),(0,b.jsx)("option",{value:"G",children:"G"}),(0,b.jsx)("option",{value:"L",children:"L"}),(0,b.jsx)("option",{value:"ML",children:"ML"}),(0,b.jsx)("option",{value:"UD",children:"UD"})]})}),(0,b.jsx)("button",{type:"button",onClick:()=>{let a;(a=[...m]).splice(d,1),n(a)},className:"text-red-500 hover:text-red-700 p-1",children:(0,b.jsx)(g.TrashIcon,{className:"w-5"})})]},c.key)})})]}),(0,b.jsxs)("div",{className:"mb-6 mt-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-bold",children:"Método de elaboración (Pasos)"}),(0,b.jsxs)("button",{type:"button",onClick:()=>{q([...p,{key:crypto.randomUUID(),order:p.length+1,description:"",action:"",subAction:"",ingredientId:""}])},className:"flex items-center gap-1 rounded bg-blue-100 px-3 py-1 text-sm text-blue-600 hover:bg-blue-200",children:[(0,b.jsx)(f.PlusIcon,{className:"w-4"})," Añadir Paso"]})]}),0===p.length&&(0,b.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No hay pasos definidos."}),(0,b.jsx)("div",{className:"space-y-4",children:p.map((a,c)=>(0,b.jsxs)("div",{className:"flex flex-col gap-2 p-3 bg-white rounded border border-gray-200 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,b.jsx)("span",{className:"flex-none flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 font-bold text-xs text-gray-600 mt-1",children:a.order}),(0,b.jsx)("textarea",{className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",rows:2,placeholder:"",value:a.description,onChange:a=>s(c,"description",a.target.value)}),(0,b.jsx)("button",{type:"button",onClick:()=>{let a;(a=[...p]).splice(c,1),q(a.map((a,b)=>({...a,order:b+1})))},className:"text-red-500 hover:text-red-700 p-1",children:(0,b.jsx)(g.TrashIcon,{className:"w-5"})})]}),(0,b.jsxs)("div",{className:"ml-8 flex flex-wrap gap-2 items-center",children:[(0,b.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:a.action||"",onChange:a=>s(c,"action",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"-- Acción --"}),Object.keys(r).map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),a.action&&r[a.action]&&(0,b.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6",value:a.subAction||"",onChange:a=>s(c,"subAction",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"-- Técnica --"}),r[a.action].map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{className:"text-xs rounded border-gray-200 py-1 pl-2 pr-6 max-w-[150px]",value:a.ingredientId||"",onChange:a=>s(c,"ingredientId",a.target.value),children:[(0,b.jsx)("option",{value:"",children:"-- Ingrediente Relacionado --"}),t.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]},a.key))})]}),(0,b.jsx)("div",{"aria-live":"polite","aria-atomic":"true",children:k.message&&(0,b.jsx)("p",{className:"mt-2 text-sm text-red-500",children:k.message})})]}),(0,b.jsxs)("div",{className:"mt-6 flex justify-end gap-4",children:[(0,b.jsx)(e.default,{href:"/dashboard/recipes",className:"flex h-10 items-center rounded-lg bg-gray-100 px-4 text-sm font-medium text-gray-600 transition-colors hover:bg-gray-200",children:"Cancelar"}),(0,b.jsx)("button",{type:"submit",className:"flex h-10 items-center rounded-lg bg-blue-600 px-4 text-sm font-medium text-white transition-colors hover:bg-blue-500",children:"Guardar Receta"})]})]})}a.s(["default",()=>i],75896)}];

//# sourceMappingURL=apps_web_app_ui_recipes_create-form_tsx_8a4ac3fc._.js.map