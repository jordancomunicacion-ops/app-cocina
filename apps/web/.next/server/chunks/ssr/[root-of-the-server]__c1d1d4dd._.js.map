{"version":3,"sources":["../../../../../../apps/web/app/dashboard/recipes/%5Bid%5D/print/page.tsx"],"sourcesContent":["import { prisma } from '@/lib/prisma';\r\nimport { notFound } from 'next/navigation';\r\nimport { Ingredient, RecipeItem, RecipeStep } from '@prisma/client';\r\n\r\nexport default async function Page({ params }: { params: Promise<{ id: string }> }) {\r\n    const { id } = await params;\r\n\r\n    const recipe = await prisma.recipe.findUnique({\r\n        where: { id },\r\n        include: {\r\n            items: {\r\n                include: { ingredient: true, subRecipe: true }\r\n            },\r\n            steps: {\r\n                orderBy: { order: 'asc' }\r\n            }\r\n        },\r\n    });\r\n\r\n    if (!recipe) {\r\n        notFound();\r\n    }\r\n\r\n    // Helper to format currency\r\n    const formatCurrency = (amount: number) => {\r\n        return new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' }).format(amount);\r\n    };\r\n\r\n    return (\r\n        <main className=\"min-h-screen bg-white text-black p-8 print:p-0\">\r\n            {/* Print Button (Hidden in Print) */}\r\n            <div className=\"mb-4 print:hidden flex justify-end\">\r\n                <button\r\n                    onClick=\"window.print()\"\r\n                    className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n                >\r\n                    Imprimir Ficha\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"max-w-[210mm] mx-auto border border-gray-300 p-8 print:border-0 print:p-0\">\r\n\r\n                {/* Header */}\r\n                <div className=\"text-center mb-6\">\r\n                    <h1 className=\"text-4xl font-bold border-2 border-black py-2\">SOTO Del Prior</h1>\r\n                    <div className=\"mt-2 border-2 border-black py-1\">\r\n                        <h2 className=\"text-xl font-bold uppercase\">Ficha técnica</h2>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Top Info Grid */}\r\n                <div className=\"grid grid-cols-2 gap-8 mb-6\">\r\n                    {/* Left: Recipe Name */}\r\n                    <div className=\"flex\">\r\n                        <div className=\"w-1/3 bg-black text-white font-bold p-2 flex items-center justify-center uppercase\">\r\n                            Receta:\r\n                        </div>\r\n                        <div className=\"w-2/3 border-2 border-black p-2 flex items-center justify-center font-bold text-lg\">\r\n                            {recipe.name}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Category & Packaging */}\r\n                    <div className=\"flex flex-col gap-0 border-2 border-black\">\r\n                        <div className=\"flex border-b border-black\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 text-center text-sm uppercase\">Tipo de elaboración</div>\r\n                            <div className=\"w-1/2 bg-gray-200 p-1 text-center font-bold\">{recipe.category || '-'}</div>\r\n                        </div>\r\n                        <div className=\"flex\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 text-center text-sm uppercase\">Envasado</div>\r\n                            <div className=\"w-1/2 bg-white p-1 text-center\">{recipe.packaging || '-'}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-8 mb-6\">\r\n                    {/* Production & Portions */}\r\n                    <div className=\"flex flex-col gap-2\">\r\n                        <div className=\"flex border-2 border-black\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 pl-4 uppercase\">Producción</div>\r\n                            <div className=\"w-1/2 bg-white p-1 text-center font-bold\">{recipe.yieldQuantity} {recipe.yieldUnit}</div>\r\n                        </div>\r\n                        <div className=\"flex border-2 border-black\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 pl-4 uppercase\">Número de porciones</div>\r\n                            <div className=\"w-1/2 bg-white p-1 text-center font-bold\">{recipe.portions || '-'}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Times */}\r\n                    <div className=\"flex flex-col gap-2\">\r\n                        <div className=\"flex border-2 border-black\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 pl-4 uppercase\">Tiempo de preparación</div>\r\n                            <div className=\"w-1/2 bg-white p-1 text-center\">{recipe.prepTime ? `${recipe.prepTime} mins` : '-'}</div>\r\n                        </div>\r\n                        <div className=\"flex border-2 border-black\">\r\n                            <div className=\"w-1/2 bg-black text-white font-bold p-1 pl-4 uppercase\">Tiempo de cocción</div>\r\n                            <div className=\"w-1/2 bg-white p-1 text-center\">{recipe.cookTime ? `${recipe.cookTime} mins` : '-'}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Ingredients Table */}\r\n                <div className=\"mb-6\">\r\n                    <table className=\"w-full border-2 border-black text-sm\">\r\n                        <thead className=\"bg-black text-white uppercase\">\r\n                            <tr>\r\n                                <th className=\"p-1 text-left w-1/2\">Producto</th>\r\n                                <th className=\"p-1 text-center w-1/4\">Unidades</th>\r\n                                <th className=\"p-1 text-center w-1/4\">Cantidad en {recipe.yieldUnit || 'KG/L'}</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {recipe.items.map((item, i) => (\r\n                                <tr key={item.id} className={i % 2 === 0 ? 'bg-gray-100' : 'bg-white'}>\r\n                                    <td className=\"border border-black p-1 font-medium\">\r\n                                        {item.type === 'INGREDIENT' ? item.ingredient?.name : item.subRecipe?.name}\r\n                                    </td>\r\n                                    <td className=\"border border-black p-1 text-center\">\r\n                                        {item.unit === 'UD' ? item.quantityGross : ''}\r\n                                    </td>\r\n                                    <td className=\"border border-black p-1 text-center font-bold\">\r\n                                        {item.unit !== 'UD' ? item.quantityGross : ''}\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                            {/* Empty rows to fill space if needed */}\r\n                            {Array.from({ length: Math.max(0, 10 - recipe.items.length) }).map((_, i) => (\r\n                                <tr key={`empty-${i}`} className=\"h-6\">\r\n                                    <td className=\"border border-black\"></td>\r\n                                    <td className=\"border border-black\"></td>\r\n                                    <td className=\"border border-black\"></td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n                {/* Method / Steps */}\r\n                <div className=\"mb-6 border-2 border-black\">\r\n                    <div className=\"bg-black text-white font-bold p-1 text-center uppercase\">Método de elaboración</div>\r\n                    <div>\r\n                        {(recipe.steps && recipe.steps.length > 0) ? (\r\n                            recipe.steps.map((step) => (\r\n                                <div key={step.id} className=\"flex border-b border-black last:border-b-0 text-sm\">\r\n                                    <div className=\"w-10 bg-gray-200 border-r border-black flex items-center justify-center font-bold flex-shrink-0\">\r\n                                        {step.order}\r\n                                    </div>\r\n                                    <div className=\"p-2 w-full\">\r\n                                        {step.description}\r\n                                    </div>\r\n                                </div>\r\n                            ))\r\n                        ) : (\r\n                            <div className=\"p-4 text-center text-gray-400 italic\">Sin pasos definidos</div>\r\n                        )}\r\n                        {/* Legacy instructions fallback if no steps */}\r\n                        {(!recipe.steps || recipe.steps.length === 0) && recipe.instructions && (\r\n                            <div className=\"p-2 border-t border-black text-sm whitespace-pre-wrap\">\r\n                                {recipe.instructions}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Notes (Footer) */}\r\n                <div className=\"text-sm font-bold italic mt-4\">\r\n                    Notas:\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <script dangerouslySetInnerHTML={{\r\n                __html: `\r\n                // Auto-print option or just helper\r\n            `}} />\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}